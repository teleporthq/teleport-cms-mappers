"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const i=require("node:process"),l=require("node:path"),u=/api::([^.\s]+)/,a=["etnry.create","entry.publish","entry.unpublish","entry.update","entry.delete"],d=async(n,e)=>{const r=[];if(console.log("[ON-DEMAND_ISR]: Received a request"),i.env?.TELEPORTHQ_ISR_TOKEN!==n.query?.TELEPORTHQ_ISR_TOKEN)return r;const t=n.body;if(a.includes(t.event)===!1)return console.log(`[ON-DEMAND_ISR]: Received an event that is not allowed: ${t.event}`),r;const c=Object.values(e).filter(o=>{const s=p(o.contentType);if(s&&o.contentType===s)return o}).map(o=>y(t.entry,o));return r.push(...c),r.filter(Boolean)},y=(n,e)=>{if(!("dynamicRouteAttribute"in e))return e.route?.startsWith("/")?e.route:`/${e.route}`;const r=n[e.dynamicRouteAttribute],t=l.join(e.route,String(r));return t.startsWith("/")?t:`/${t}`},p=n=>{const e=n.match(u);return e?e[1]:null};exports.revalidate=d;

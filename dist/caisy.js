"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const o=async t=>{if(t.status==401||t.status==403)throw new Error(`getEntriesByContentType from caisy auth or permission issue: ${t.statusText}`);if(t.status!=200)throw new Error(`getEntriesByContentType from caisy - internal error fetching entries from caisy: ${t.statusText}`);const e=await t.json();if(e.errors)throw new Error(`getEntriesByContentType from caisy - internal error fetching entries from caisy: ${JSON.stringify(e.errors)}`);return e.data[Object.keys(e.data)[0]].edges.map(s=>s.node)},u=async t=>{const{projectId:e,query:r}=t,s=`https://cloud.caisy.io/api/v3/e/${e}/graphql`,n=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json","x-caisy-token":process.env.CMS_ACCESS_TOKEN},body:JSON.stringify({query:r})});return o(n)},g=async t=>{const{projectId:e,query:r,attribute:s}=t,n=`https://cloud.caisy.io/api/v3/e/${e}/graphql`,i=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json","x-caisy-token":process.env.CMS_ACCESS_TOKEN},body:JSON.stringify({query:r,variables:{value:(t==null?void 0:t[`${s}`])??""}})});return o(i)},f=async t=>{const{projectId:e,query:r}=t,s=`https://cloud.caisy.io/api/v3/e/${e}/graphql`,n=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json","x-caisy-token":process.env.CMS_ACCESS_TOKEN},body:JSON.stringify({query:r,variables:{first:t.page*t.perPage}})});if(n.status==401||n.status==403)throw new Error(`getEntriesByContentType from caisy auth or permission issue: ${n.statusText}`);if(n.status!=200)throw new Error(`getEntriesByContentType from caisy - internal error fetching entries from caisy: ${n.statusText}`);const i=await n.json();if(i.errors)throw new Error(`getEntriesByContentType from caisy - internal error fetching entries from caisy: ${JSON.stringify(i.errors)}`);const{endCursor:a,hasNextPage:c}=i.data[Object.keys(i.data)[0]].pageInfo;if(!c)return{};const y=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json","x-caisy-token":process.env.CMS_ACCESS_TOKEN},body:JSON.stringify({query:r,variables:{first:t.perPage,after:a}})});return o(y)},p=async t=>await u(t),h=async t=>await g(t),d=async t=>await f(t);exports.getEntities=p;exports.getEntitiesWithPagination=d;exports.getEntyByAttribute=h;
